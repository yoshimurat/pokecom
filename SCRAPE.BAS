REM SCRAPE.BAS FOR PC-G850
REM  OBJECTIVE   :黒いマルまで移動してください。
REM  HOW TO PLAY :Q:加速  A:減速　左右キー:方向転換
REM  DESCRIPTION :画面色が反転したままの場合は一度電源を入れなおして下さい

100 CLEAR:RANDOMIZE
110 R=1,S=0,MX=128,MY=40
120 DIM B$(0):DIM GX(6):DIM GY(6)
130 *LD1
140 FOR I=0 TO 6:READ GX(I):NEXT
150 FOR I=0 TO 6:READ GY(I):NEXT
160 *INIT
170 CLS:F=0
180 IF R=1 GOSUB *R1
190 IF R=2 GOSUB *R2
200 IF R=3 GOSUB *R3
210 IF R=4 GOSUB *R4
220 IF R>4 GOSUB *R5
230 LOCATE 1,5:PRINT "SC:"
240 LOCATE 10,5:PRINT "T:"
250 LOCATE 18,5:PRINT "R:"
260 LOCATE 4,5:PRINT S
270 LOCATE 12,5:PRINT T
280 LOCATE 20,5:PRINT R
290 LINE(0,0)-(MX,MY),B
300 GOSUB *LD2
310 CIRCLE(GX(R)*8+4,GY(R)*8+4),3,,,,,6
320 *TI
330 Z$=INKEY$
340 IF Z$="Q" AND V<2.3 LET V=V+.05
350 IF Z$="A" AND V>-2.3 LET V=V-.05
360 IF Z$=CHR$(14) LET D=D+10
370 IF Z$=CHR$(15) LET D=D-10
380 NX=X+V*COS D:NY=Y+V*SIN D
390 IF POINT(NX,NY) GOTO *CHK
400 *MOVE
410 IF NOT(INT(NX)=INT(X)) LET S=S+1
420 IF NOT(INT(NY)=INT(Y)) LET S=S+2
430 LINE(NX,NY)-(X,Y)
440 X=NX,Y=NY,T=T-1
450 LOCATE 4,5:PRINT S
460 LOCATE 12,5:PRINT T
470 LOCATE 20,5:PRINT R
480 IF T=0 GOTO *EXP ELSE GOTO *TI
490 *CHK
500 B=INT(NX):C=INT(NY)
510 IF C=INT(Y) AND B=INT(X) GOTO *MOVE
520 IF NX>GX(R)*8 AND NX<GX(R)*8+8 AND NY>GY(R)*8 AND NY<GY(R)*8+8 GOTO *LAND
530 *EXP
540 FOR I=0 TO 40:LINE(NX,NY)-(RND(MX),RND(MY)),X:NEXT
550 OUT &H40,&HA7
560 LOCATE 1,4:PRINT "AMAI..":CALL 48381:OUT &H40,&HA6:R=1,S=0
570 RESTORE:GOTO *LD1
580 *LAND
590 LOCATE 5,4:PRINT "WELL DONE..":CALL 48381:R=R+1,S=S+T,D=0:GOTO *INIT
600 *LD2
610 FOR I=1 TO 6:READ B0:GOSUB *D2BIN
620 Q=16
630 FOR J=LEN(B$(0)) TO 1 STEP -1
640 IF MID$(B$(0),J,1)="1" LINE((Q-1)*8,(I-1)+8)-(Q*8,I*8),BF:Q=Q-1
650 NEXT:NEXT:RETURN
660 *D2BIN
670 B$(0)=""
680 *D2B
690 B1=INT(B0/2):B2=B0-2*B1
700 B$(0)=CHR$(B2+48)+B$(0)
710 IF B1>0 LET B0=B1:GOTO *D2B
720 RETURN
730 *R1
740 T=200,V=1,D=0,X=12,Y=26:RETURN
750 *R2
760 T=250,V=1.5,D=180,X=MX-12,Y=20:RETURN
770 *R3
780 T=600,V=1.5,D=180,X=MX-4,Y=MY-4:RETURN
790 *R4
800 T=500,V=.3,D=90,X=20,Y=4:RETURN
810 *R5
820 T=400,V=1,D=90,X=MX-20,Y=4]:RETURN
830 DATA 15,0,15,0,15,15
840 DATA 0,2,0,0,0,0
850 DATA 65520,32772,32772,32769,65535
860 DATA 127,32383,20289,257,61567
870 DATA 64520,61474,62195,62092,63520
880 DATA 20545,18200,31910,1120,53516
890 DATA 33920,6370,25918,1568,12427
900 DATA 33920,6370,25918,1568,12427
